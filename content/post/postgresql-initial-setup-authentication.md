+++
title = "PostgreSQL initial setup (authentication)"
date = 2009-08-24T01:00:00Z
updated = 2010-01-19T11:44:41Z
tags = ["database", "security", "authentication", "postgresql"]
blogimport = true 
type = "post"
+++

If you followed my <a href="http://xenoterracide.blogspot.com/2009/03/postgresql-initial-setup-users-and.html">last initial setup</a> post on creating users and are running a default install of postgres you currently should be able to access the database on your cli. However, many distributions do not install postgres in a default manner. A great many distributions make the default authentication for sockets <code>ident sameuser</code>. This is technically much more secure than <code>trust</code> which is the default. However, you may find yourself locked out of your database on the local cli if you make the database name different. I personally was confused about this after first encountering this setting.<br /><br />So, we don't want <code>trust</code> but we want to use a db username other than our shell login, most likely because we have more than one database. There are several options but I personally think <code>ident</code> is a good one. However, since we don't want to use the same shell login name we have to modify <code>pg_ident.conf</code> and <code>pg_hba.conf</code>, locations vary by distribution.<br /><br />In <code>pg_ident.conf</code> you have to create a line with the following formatting.<br /><br /><code># MAPNAME     IDENT-USERNAME    PG-USERNAME</code><br /><br />I think it's mostly straightforward. In case it isn't, MAPNAME is an arbitrary identifier, sameuser is actually the mapname in <code>ident sameuser</code> A quick example from mine would be<br /><br /><code>devel xenoterracide webdev</code>where my unix username is xenoterracide but I created the database user webdev. If you wanted you could add another devel mapname with another user or the same unix account different db account, or even a different unix account same db account, etc.<br /><br />After you add all the various mappings you need to add or change the ident in pg_hba.conf. You can only have one method per type/database/user/address combination. so in pg_hba.conf you want to change <br /><br /><code> local all all <trust or ident sameuser></code> to <code>local all all ident devel</code><br /><br />If you want postgres to ask for a password use <code>md5</code> instead of <code>ident</code> further information can be found at <a href="http://www.postgresql.org/docs/current/interactive/auth-methods.html">http://www.postgresql.org/docs/current/interactive/auth-methods.html</a>.<br /><br />if you have any problems you might want to see <a href="http://xenoterracide.blogspot.com/2010/01/postgresql-initial-setup-authentication.html">part 2</a>.<div class="blogger-post-footer"><br />--<br />
This <span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" rel="dc:type">work</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.xenoterracide.com" property="cc:attributionName" rel="cc:attributionURL">Caleb Cushing</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.</div>
