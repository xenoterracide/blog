+++
title = "Quick sha1sum with Crypto++"
date = 2009-09-22T01:59:00Z
updated = 2009-09-22T02:27:42Z
tags = ["security", "C++", "programming", "code example", "cryptography"]
blogimport = true 
type = "post"
+++

I've been working on <a href="http://github.com/xenoterracide/korama">Korama</a>. I was originally planning on hashing each music file and using the sha1 for the track primary key. However, after benchmarking an actual implementation. I've decided that it's too slow, 20 minutes for 3k+ tracks, also my program was about 5 minutes slower than <code>find ... -exec sha1sum</code> not sure on the reason why. However, since I had problems figuring out how to do it I figure I'll post a basic sha1sum program that I made with the help of people on the <a href="http://www.cryptopp.com/">Crypto++</a> Mailing List.<br /><br />Include's are mangled due to blogger filtering<br /><code><pre><br />#include < cryptopp/sha.h ><br />#include < cryptopp/hex.h ><br />#include < cryptopp/files.h ><br />#include < string ><br />#include < iostream ><br /><br />using namespace std;<br /><br />int main(int argc, char *argv[])<br />{<br />    char *file = argv[1];<br />    string result;<br />    CryptoPP::SHA1 hash;<br /><br />    CryptoPP::FileSource( ( file ),true,<br />        new CryptoPP::HashFilter(<br />            hash, new CryptoPP::HexEncoder(<br />                new CryptoPP::StringSink(result), false)<br />        )<br />    );<br />    cout << result << endl;<br />    return 0;<br />}<br /></pre></code><br /><br />it can be built with.<br /><br /><code>g++ sha1.cpp -lcryptopp -o sha1sum</code><br /><br />and tested with<br /><br /><code>./sha1sum filename</code><br />It's not meant to be a exactly compatible implementation of sha1sum. it doesn't output the filename, it isn't capable of handling more than one file argument, and if no argument is provided it crashes. I know I haven't actually explained how the crypo++ code works, but I hope just posting this here will help someone in the future.<div class="blogger-post-footer"><br />--<br />
This <span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" rel="dc:type">work</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.xenoterracide.com" property="cc:attributionName" rel="cc:attributionURL">Caleb Cushing</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.</div>
