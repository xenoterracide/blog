+++
title = "My new Love/Hate Relationship with Dist::Zilla"
date = 2010-04-27T08:30:00Z
updated = 2010-04-27T09:19:42Z
tags = [ "perl", "review", "Dist::Zilla"]
blogimport = true 
type = "post"
+++

<a href="http://search.cpan.org/dist/Dist-Zilla/">Dist::Zilla</a> is a great release tool, code generator, and it just plain takes the boring part of doing a release away from you.That having been said, it does, imo, horrible things to your source repository. "But, Caleb, it cleans up your source repository you can remove a lot of excess stuff you don't really need to be storing there". Well... I disagree, to the point that I've used every explicative in the book to express my displeasure. Let me explain why I disagree.<br /><br />First let me explain my use cases. I have only one package on CPAN, <a href="http://search.cpan.org/dist/Template-ShowStartStop/lib/Template/ShowStartStop.pm">Template::ShowStartStop</a> and it's relatively simple to the point that Dist::Zilla is almost overkill (but I still find it nice). I also maintain a sizeable portion of CPAN on Arch Linux's <a href=" http://aur.archlinux.org/packages.php?SeB=m&L=2&K=xenoterracide">AUR</a>. In addition to standard CPAN Packaging for my own package I created a <a href="http://aur.archlinux.org/packages.php?ID=35120">-git package</a> which allows me to install directly from my source repository on <a href="http://github.com/xenoterracide/Template-ShowStartStop">Github</a>. That worked wonderfully well until I started using Dist::Zilla (note: I haven't gotten a poorly working (read hack that's buggy) version now).<br /><br />So Dist::Zilla is great for CPAN, no problem for normal downstream packages, but makes things more painful for Version Control Users. "But Caleb, it does nice things for me for version control". Yes it does, but I think it also has some consequences that people don't realize. If you know how Dist::Zilla works pretend that you don't.<br /><br />Look at my <a href="http://github.com/xenoterracide/Template-ShowStartStop">repo</a> What License is my code licensed under? usually this is in the COPYING file. There's no COPYING file there. How do I install it? No README either, oh and the module isn't complete as is things like version are stripped so Dist::Zilla can generate them for me. This list goes on and on all basically leading back to my issue. Why does Dist::Zilla have to take these things out of my source repository?<br /><br />The answer was... you wouldn't store .o files in your repository would you? why would you store these generated files... oh I dunno... because someone shouldn't have to install Dist::Zilla just to use my latest git? and they aren't like .o files because those are binarily specific to a lot of things and won't be useful on most other machines, unlike these files.<br /><br />Let's say Dist::Zilla has a bug in what they generate for code. They fix it, I update, all is good for me. Someone else who hasn't updated Dist::Zilla downloads the code and builds and hits the bug... they complain to me. I explain it to them, they update Dist::Zilla, they're happy, I'm happy. But we could have avoided this, if I stored all the output in my repo they'd never have to worry about Dist::Zilla.<br /><br />So I've been told this will never be fixed because they don't want to clobber the existing files, plus the whole... these are like .o files, thing. Ok, clobber == bad. So how could we fix it so I'm happy? and everyones happy. We should a directory <code>src</code> shall be the source of all non generated code. Much like when working with compiled code you have a <code>src</code> directory for source files and a directory for output. the lib that's still here will be the final generated lib. All the top level files will also be generated. Only the stuff in <code>src</code> is what should be worked on. And the generated README will give all these wonderful instructions that will now be presented to users visiting the github repo. And when I'm writing a -git package I won't have to include any dzil instructions because I don't need to generate this code all the time.<br /><br />and you know what? if people don't want to store generated files in there vcs they can always use something like .gitignore. So everybody should be happy.<br /><br />For backcompat just make it a configuration in dist.ini. We can have a [src] dir which could be . for those who want it the way it works now. and an [output] dir.<br /><br />Will Dist::Zilla be worth this pain? I'm not sure.<div class="blogger-post-footer"><br />--<br />
This <span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" rel="dc:type">work</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.xenoterracide.com" property="cc:attributionName" rel="cc:attributionURL">Caleb Cushing</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.</div>
